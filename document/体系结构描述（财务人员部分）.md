##### 用户界面层模块的职责

| 模块                | 职责                             |
| ----------------- | ------------------------------ |
| MainFrame         | 主界面Frame，负责界面的显示和界面的跳转         |
| AccountFrame      | 账户管理界面Frame，负责账户管理界面的显示和跳转     |
| AccountIODocFrame | 创建收付款单Frame，负责收付款单界面的显示和跳转     |
| CostDocFrame      | 创建现金费用单Frame，负责现金费用单界面的显示和跳转   |
| AdminFrame        | 系统管理员管理用户Frame，负责系统管理员界面的显示和跳转 |
|                   |                                |
|                   |                                |
|                   |                                |
|                   |                                |

##### 用户界面层模块的接口规范



##### 逻辑层模块的职责

| 模块         | 职责                       |
| ---------- | ------------------------ |
| userbl     | 负责实现管理用户界面所需要的服务         |
| accountbl  | 负责实现管理账户界面所需要的服务         |
| logbl      | 负责实现日志界面所需要的服务           |
| documentbl | 负责实现各种单据及与单据有关服务界面所需要的服务 |



##### documentbl 模块的接口规范

- 提供的服务

  | 名称                     | 条目   | 详情                                       |
  | ---------------------- | ---- | ---------------------------------------- |
  |                        | 语法   | `public CostVO createCostDoc()`          |
  | CostDoc.createCostDoc  | 前置条件 | 得到数据                                     |
  |                        | 后置条件 | 返回包含根据所得数据生成的单据编号以及当前操作员的VO对象            |
  |                        | 语法   | `public ResultMessage commitDoc(DocVO doc)` |
  | CostDoc.commitDoc      | 前置条件 | 传入的对象不为`null`，且包含的信息正确有效                 |
  |                        | 后置条件 | 将该单据传送给审批程序，并更新持久化存储内容                   |
  |                        | 语法   | `public String getState(String ID)`      |
  | CostDoc.getState       | 前置条件 | 输入有效的ID                                  |
  |                        | 后置条件 | 根据ID查找相应的单据，返回对应单据的审批状态                  |
  |                        | 语法   | `public CostDocVO getHistoryDoc(String ID)` |
  | CostDoc.getHistoryDoc  | 前置条件 | 输入有效的单据编号(ID)                            |
  |                        | 后置条件 | 得到数据，返回对应的对象                             |
  |                        | 语法   | `public ArrayList<AccountVO> getAccountList` |
  | CostDoc.getAccountList | 前置条件 | 用户请求选择账户                                 |
  |                        | 后置条件 | 返回账户列表                                   |

- 需要的服务（需接口）

  | 服务名                                   | 服务            |
  | ------------------------------------- | ------------- |
  | DocDataService.insert(DocPO po)       | 存储单一持久化对象     |
  | DocDataService.findByUser(int userid) | 得到存储的多个持久化对象  |
  | DocDataService.find(String ID)        | 根据ID得到单一持久化对象 |
  | DocDataService.events()               | 得到存储的多个持久化对象  |
  | AccountDataService.getAll()           | 得到存储的多个持久化对象  |


- 提供的服务

  | 名称                                 | 条目   | 详情                                       |
  | ---------------------------------- | ---- | ---------------------------------------- |
  |                                    | 语法   | `public AccountVO createAccountInOut()`  |
  | AccountInOutDoc.createAccountInOut | 前置条件 | 得到数据                                     |
  |                                    | 后置条件 | 返回根据所得数据生成的单据编号以及当前操作员的AccountVO对象       |
  |                                    | 语法   | `public ResultMessage commitDoc(AccountInOutDocVO doc)` |
  | AccountInOutDoc.commitDoc          | 前置条件 | 传入的对象不为`null`，且包含的信息正确有效                 |
  |                                    | 后置条件 | 将该单据传送给审批程序，并更新持久化存储内容                   |
  |                                    | 语法   | `public String getState(String ID)`      |
  | AccountInOutDoc.getState           | 前置条件 | 输入有效的ID                                  |
  |                                    | 后置条件 | 根据ID查找相应的单据，返回对应单据的审批状态                  |
  |                                    | 语法   | `public AccountInOutDocVO getHistoryDoc(String ID)` |
  | AccountInOutDoc.getHistoryDoc      | 前置条件 | 输入有效的单据编号(ID)                            |
  |                                    | 后置条件 | 得到数据，返回对应的对象                             |
  |                                    | 语法   | `public ArrayList<CustomerVO> getCustomerList()` |
  | AccountInOutDoc.getCustomerList    | 前置条件 | 用户请求选择客户                                 |
  |                                    | 后置条件 | 返回客户列表                                   |
  |                                    | 语法   | `public ArrayList<AccountVO> getAccountList` |
  | AccountInOutDoc.getAccountList     | 前置条件 | 用户请求选择账户                                 |
  |                                    | 后置条件 | 返回账户列表                                   |

- 需要的服务（需接口）

  | 服务名                                     | 服务            |
  | --------------------------------------- | ------------- |
  | DocDataService.insert(DocPO po)         | 存储单一持久化对象     |
  | DocDataService.findByType(DocType type) | 得到存储的多个持久化对象  |
  | DocDataService.find(String ID)          | 根据ID得到单一持久化对象 |
  | CustomerDataService.getAll()            | 得到存储的多个持久化对象  |
  | AccountDataService.getAll()             | 得到存储的多个持久化对象  |


- 提供的服务

  | 名称                            | 条目   | 详情                                       |
  | ----------------------------- | ---- | ---------------------------------------- |
  |                               | 语法   | `public InitVO getInitInfo()`            |
  | Initialization.getInitInfo    | 前置条件 | 用户请求期初建账                                 |
  |                               | 后置条件 | 得到历史数据，返回根据所得数据生成的对象（该对象包括期初的一切信息）       |
  |                               | 语法   | `public ResultMessage commit(InitVO vo)` |
  | Initialization.commit         | 前置条件 | 传入的对象不为`null`，且包含的信息正确有效                 |
  |                               | 后置条件 | 更新持久化存储内容，替换正在使用的账目对象                    |
  |                               | 语法   | `public ArrayList<InitVO> getHistoryInfo()` |
  | Initialization.getHistoryInfo | 前置条件 | 用户请求查看历史期初信息                             |
  |                               | 后置条件 | 返回对应对象的列表                                |

- 需要的服务（需接口）

  | 服务名                                  | 服务           |
  | ------------------------------------ | ------------ |
  | DocDataService.newAccount(InitPO po) | 存储单一持久化对象    |
  | DocDataService.getInitInfo()         | 得到存储的多个持久化对象 |
  | Commodity.getCommodityList()         | 得到存储的多个持久化对象 |
  | CustomerDataService.getAll()         | 得到存储的多个持久化对象 |
  | AccountDataService.getAll()          | 得到存储的多个持久化对象 |

##### userbl 模块的接口规范

- 提供的服务

  | 名称                  | 条目   | 详情                                       |
  | ------------------- | ---- | ---------------------------------------- |
  |                     | 语法   | `public ArrayList<UserVo> getUserList ()` |
  | User.getUserList    | 前置条件 | 得到数据                                     |
  |                     | 后置条件 | 返回用户列表                                   |
  |                     | 语法   | `public ResultMessage addUser(UserVo vo)` |
  | User.addUser        | 前置条件 | 传入有效的对象                                  |
  |                     | 后置条件 | 增加新的用户，更新持久化存储内容                         |
  |                     | 语法   | `public ArrayList<UserVO> findUser(String keyword)` |
  | User.findUser       | 前置条件 | 输入有效的关键字                                 |
  |                     | 后置条件 | 根据关键字查找是否存在相应的用户，若存在匹配的用户则返回相应对象列表，若不存在匹配项则返回空列表 |
  |                     | 语法   | `public UserVO getUser(String id)`       |
  | User.getUser        | 前置条件 | 输入有效的用户名                                 |
  |                     | 后置条件 | 得到数据，返回名称对应的对象                           |
  |                     | 语法   | `public ResultMessage deleteUser(String ID)` |
  | User.deleteUser     | 前置条件 | 输入有效的用户ID                                |
  |                     | 后置条件 | 删除相应的用户，更新持久化存储内容                        |
  |                     | 语法   | `public void modifyUser(UserVO vo)`      |
  | User.modifyUser     | 前置条件 | 输入有效的用户对象                                |
  |                     | 后置条件 | 更改所修改的用户信息，更新持久化存储的数据                    |
  |                     | 语法   | `public String generateJobNum(UserVO vo)` |
  | User.generateJobNum | 前置条件 | 用户请求添加新的账号                               |
  |                     | 后置条件 | 返回相应字符串                                  |
  |                     | 语法   | `public ResultMessage login(String username, String password)` |
  | User.logIn          | 前置条件 | password符合输入规则                           |
  |                     | 后置条件 | 查找是否存在相应的User，根据输入的password返回登陆验证的结果     |
  |                     | 语法   | `public ResultMessage logOut(UserVo vo)` |
  | User.logOut         | 前置条件 | 传入有效的UserVO对象                            |
  |                     | 后置条件 | 查找是否存在相应的User，根据传入的对象返回登出结果              |

- 需要的服务（需接口）

  | 服务名                                  | 服务                 |
  | ------------------------------------ | ------------------ |
  | UserDataService.getAll()             | 得到目前存储的所有用户的持久化对象  |
  | UserDataService.get(String id)       | 根据ID得到单一持久对象       |
  | UserDataService.create(UserPO po)    | 插入单一持久化对象          |
  | UserDataService.update(UserPO po)    | 更新单一持久化对象          |
  | UserDataService.delete(UserPO po)    | 删除单一持久化对象          |
  | UserDataService.find(String keyword) | 根据关键字查找多个持久化对象并返回  |
  | DataBaseFactory.getUserDataBase      | 得到Account数据库的服务的引用 |

##### logbl 模块的接口规范

- 提供的服务

  | 名称             | 条目   | 详情                                       |
  | -------------- | ---- | ---------------------------------------- |
  |                | 语法   | `public ArrayList<LogVo> getLogListByTime (long from, long to)` |
  | Log.getLogList | 前置条件 | 输入有效的时间范围                                |
  |                | 后置条件 | 根据时间范围返回日志列表                             |
  |                | 语法   | `public LogVO getLog(String id)`         |
  | Log.getLog     | 前置条件 | 传入有效的id                                  |
  |                | 后置条件 | 根据id返回对应的                                |
  |                | 语法   | `public ResultMessage addLog(LogVO vo)`  |
  | Log.addLog     | 前置条件 | 用户的操作请求需要被记录                             |
  |                | 后置条件 | 增加新的Log，更新持久化存储                          |

- 需要的服务（需接口）

  | 服务名                                     | 服务                |
  | --------------------------------------- | ----------------- |
  | LogDataService.findByTime(String range) | 得到目前存储的所有用户的持久化对象 |
  | LogDataService.find(String id)          | 根据ID得到单一持久对象      |
  | LogDataService.insert(LogPO po)         | 插入单一持久化对象         |

##### 数据层的模块的职责

| 模块                 | 职责                     |
| ------------------ | ---------------------- |
| DocDataService     | 提供各种单据的集体载入、保存、查看、修改服务 |
| AccountDataService | 提供账户数据集体载入、保存、增删改查服务   |
| LogDataService     | 提供日志数据集体载入、保存、增加、查看服务  |
| UserDataService    | 提供用户集体载入、保存、增删改查服务     |

##### 数据层模块的接口规范

- DocDataService提供的服务

| 名称                         | 条目   | 详情                                       |
| -------------------------- | ---- | ---------------------------------------- |
|                            | 语法   | `public ResultMessage newAccount(InitPO po) throws RemoteException` |
| DocDataService.newAccount  | 前置条件 | 同样ID的po在Mapper中不存在                       |
|                            | 后置条件 | 在数据库中增加一个po记录                            |
|                            | 语法   | `public ArrayList<InitPO> getInitInfo() throws RemoteException` |
| DocDataService.getInitInfo | 前置条件 | 无                                        |
|                            | 后置条件 | 返回相应的`InitPO`对象列表                        |
|                            | 语法   | `public void init() throws RemoteException` |
| DocDataService.init        | 前置条件 | 无                                        |
|                            | 后置条件 | 初始化持久化数据库                                |
|                            | 语法   | `public void finish() throws RemoteException` |
| DocDataService.finish      | 前置条件 | 无                                        |
|                            | 后置条件 | 结束持久化数据库的使用                              |

- AccountDataService提供的服务

| 名称                        | 条目   | 详情                                       |
| ------------------------- | ---- | ---------------------------------------- |
|                           | 语法   | `public ResultMessage insert(AccountPO po) throws RemoteException` |
| AccountDataService.insert | 前置条件 | 同样ID的po在Mapper中不存在                       |
|                           | 后置条件 | 在数据库中增加一个po记录                            |
|                           | 语法   | `public ArrayList<AccountPO> find(String keyword) throws RemoteException` |
| AccountDataService.find   | 前置条件 | 无                                        |
|                           | 后置条件 | 按关键字进行查找返回相应的`AccountPO`对象列表             |
|                           | 语法   | `public AccountPO get(String ID) throws RemoteException` |
| AccountDataService.get    | 前置条件 | 无                                        |
|                           | 后置条件 | 根据ID进行查找返回相应的`AccountPO`结果               |
|                           | 语法   | `public ResultMessage update(AccountPO po) throws RemoteException` |
| AccountDataService.update | 前置条件 | 数据库中已经存在相同ID的po                          |
|                           | 后置条件 | 更新一个po                                   |
|                           | 语法   | `public void init() throws RemoteException` |
| AccountDataService.init   | 前置条件 | 无                                        |
|                           | 后置条件 | 初始化持久化数据库                                |
|                           | 语法   | `public void finish() throws RemoteException` |
| AccountDataService.finish | 前置条件 | 无                                        |
|                           | 后置条件 | 结束持久化数据库的使用                              |
|                           | 语法   | `public ResultMessage delete(AccountPO po) throws RemoteException` |
| AccountDataService.delete | 前置条件 | 在数据库中存在相同ID的po                           |
|                           | 后置条件 | 删除一个po                                   |
|                           | 语法   | `public ArrayList<AccountPO> getAll() throws RemoteException` |
| AccountDataService.getAll | 前置条件 | 无                                        |
|                           | 后置条件 | 返回包含所有`AccountPO`的列表                     |

- UserDataService提供的服务

| 名称                     | 条目   | 详情                                       |
| ---------------------- | ---- | ---------------------------------------- |
|                        | 语法   | `public ResultMessage insert(UserPO po) throws RemoteException` |
| UserDataService.create | 前置条件 | 同样ID的po在Mapper中不存在                       |
|                        | 后置条件 | 在数据库中增加一个po记录                            |
|                        | 语法   | `public ArrayList<UserPO> find(String keyword) throws RemoteException` |
| UserDataService.find   | 前置条件 | 无                                        |
|                        | 后置条件 | 按关键字进行查找返回相应的`UserPO`对象列表                |
|                        | 语法   | `public UserPO get(String ID) throws RemoteException` |
| UserDataService.get    | 前置条件 | 无                                        |
|                        | 后置条件 | 根据ID进行查找返回相应的`UserPO`结果                  |
|                        | 语法   | `public void update(UserPO po) throws RemoteException` |
| UserDataService.update | 前置条件 | 在数据库中存在同样ID的po                           |
|                        | 后置条件 | 更新一个po                                   |
|                        | 语法   | `public void init() throws RemoteException` |
| UserDataService.init   | 前置条件 | 无                                        |
|                        | 后置条件 | 初始化持久化数据库                                |
|                        | 语法   | `public void finish() throws RemoteException` |
| UserDataService.finish | 前置条件 | 无                                        |
|                        | 后置条件 | 结束持久化数据库的使用                              |
|                        | 语法   | `public void delete(UesrPO po) throws RemoteException` |
| UserDataService.delete | 前置条件 | 在数据库中存在相同ID的po                           |
|                        | 后置条件 | 删除一个po                                   |
|                        | 语法   | `public ArrayList<UserPO> getAll() throws RemoteException` |
| UserDataService.getAll | 前置条件 | 无                                        |
|                        | 后置条件 | 返回包含所有`UserPO`的列表                        |
|                        | 语法   | `public void logIn(UserPO po) throws RemoteException` |
| UserDataService.logIn  | 前置条件 | 同样ID的po在Mapper中不存在                       |
|                        | 后置条件 | 在数据库中增加一个po记录                            |
|                        | 语法   | `public void logOut(UserPO po) throws RemoteException` |
| UserDataService.logOut | 前置条件 | 再数据库中存在相同ID的po                           |
|                        | 后置条件 | 删除一个po                                   |

- LogDataService提供的服务

| 名称                        | 条目   | 详情                                       |
| ------------------------- | ---- | ---------------------------------------- |
|                           | 语法   | `public void insert(LogPO po) throws RemoteException` |
| LogDataService.insert     | 前置条件 | 同样ID的po在Mapper中不存在                       |
|                           | 后置条件 | 在数据库中增加一个po记录                            |
|                           | 语法   | `public ArrayList<LogPO> find(String range) throws RemoteException` |
| LogDataService.findByTime | 前置条件 | 无                                        |
|                           | 后置条件 | 按范围进行查找返回相应的`LogPO`对象列表                  |
|                           | 语法   | `public LogPO find(String ID) throws RemoteException` |
| LogDataService.find       | 前置条件 | 无                                        |
|                           | 后置条件 | 根据ID进行查找返回相应的`UserPO`结果                  |

### 信息视角

#### 数据库表

数据库中包含UserInfo表、UserLog表、Account表、AccountIODoc表、CostDoc表、Log表、InitInfo表