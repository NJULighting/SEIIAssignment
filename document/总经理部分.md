

#### 业务逻辑层模块接口规范



##### approvalbl 模块的接口规范

- 提供的服务

| 名称                       | 条目   | 详情                                       |
| ------------------------ | ---- | ---------------------------------------- |
|                          | 语法   | `public ArrayList<HistoryDocVO> getDocumentList()` |
| Approval.getDocumentList | 前置条件 | 用户已登录                                    |
|                          | 后置条件 | 返回含有所有处于待审批状态的单据的列表的值对象                  |
|                          | 语法   | `public ResultMessage approve(HistoryDocVO vo)` |
| Approval.approve         | 前置条件 | 用户有正在查看的单据                               |
|                          | 后置条件 | 通过单据，持久化更新涉及的对象的数据                       |
|                          | 语法   | `public ResultMessage approveAll(ArrayList<HistoryDocVO> voList)` |
| Approval.approveAll      | 前置条件 | 用户有选择的要通过的单据                             |
|                          | 后置条件 | 通过所选的单据，持久化更新涉及的对象的数据                    |
|                          | 语法   | `public ResultMessage reject(HistoryDocVO vo)` |
| Approval.reject          | 前置条件 | 用户有正在查看的单据                               |
|                          | 后置条件 | 驳回单据，持久化更新涉及的对象的数据                       |
|                          | 语法   | `public ResultMessage save(HistoryDocVO vo)` |
| Approval.save            | 前置条件 | 有已修改要保存的单据                               |
|                          | 后置条件 | 持久化更新涉及的对象的数据                            |
|                          | 语法   | `public ResultMessage saveAndApprove(HistoryDocVO vo)` |
| Approval.saveAndApprove  | 前置条件 | 有已修改需要保存且同时要通过的单据                        |
|                          | 后置条件 | 通过该单据，持久化更新涉及的对象的数据                      |

- 需要的服务（需接口）

| 服务名                                 | 服务                   |
| ----------------------------------- | -------------------- |
| ApprovalDataService.getDocumentList | 返回所有处于待审批状态的单据的持久化对象 |
| ApprovalDataService.update          | 更新单一的持久化对象           |

##### 

##### promotionbl 模块的接口规范

- 提供的服务

| 名称                         | 条目   | 详情                                       |
| :------------------------- | ---- | ---------------------------------------- |
|                            | 语法   | `public ArrayList<PromotionVO> getPromotionList()` |
| Promotion.getPromotionList | 前置条件 | 用户已登录                                    |
|                            | 后置条件 | 返回含有所有促销策略的值对象的列表                        |
|                            | 语法   | `public ArrayList<PromotionVO> getBenefitsPlan(int customerLevel, ArrayList<String> CommmodityList,double total)` |
| Doc.getBenefitsPlan        | 前置条件 | 所有筛选条件合法                                 |
|                            | 后置条件 | 返回该销售单据所满足的优惠策略的值对象列表                    |
|                            | 语法   | `public ResultMessage createAndave(PromotionVO vo)` |
| Promotion.createAndSave    | 前置条件 | 用户有需要保存的新建的销售策略                          |
|                            | 后置条件 | 新建单据，持久化更新相关的对象的数据                       |
|                            | 语法   | `public ResultMessage modifyAndSave(PromotionVO vo)` |
| Promotion.modifyAndSave    | 前置条件 | 用户有需要保存的修改好的单据                           |
|                            | 后置条件 | 持久化更新相关的对象的数据                            |
|                            | 语法   | `public ResultMessage delete(PromotionVO vo)` |
| Promotion.delete           | 前置条件 | 用户有正在查看的销售策略                             |
|                            | 后置条件 | 删除该销售策略，持久化更新相关的对象的数据                    |

- 需要的服务

| 服务名                                   | 服务           |
| ------------------------------------- | ------------ |
| PromotionDataService.getPromotionList | 返回所有单据的持久化对象 |
| PromotionDataService.insert           | 插入单一持久化对象    |
| PromotionDataSerivice.update          | 更新单一持久化对象    |
| PromotionDataService.delete           | 删除单一持久化对象    |



##### docbl 模块的接口规范

- 提供的服务

| 名称                            | 条目   | 详情                                       |
| ----------------------------- | ---- | ---------------------------------------- |
|                               | 语法   | `public SaleRecordVO findSaleRecords(saleRecordFilterVO vo, DocType type)` |
| Doc.findSaleRecords           | 前置条件 | 用户已输入正确的筛选条件并确认                          |
|                               | 后置条件 | 返回符合筛选条件的所有单据                            |
|                               | 语法   | `public BussinessHitoryVO findDocuments(documentFilterVO vo)` |
| Doc.findDocuments             | 前置条件 | 用户已输入正确的筛选条件并确认                          |
|                               | 后置条件 | 返回符合筛选条件的所有单据                            |
|                               | 语法   | `public RevenueAndExpenditureVO findRevenueAndExpenditure(long StartDate,long endDate)` |
| Doc.findRevenueAndExpenditure | 前置条件 | 用户已输入正确的筛选条件并确认                          |
|                               | 后置条件 | 返回所输入时间段内的收支情况的值对象                       |
|                               | 语法   | `public ResultMessage createGiftDoc (GiftDocVO vo)` |
| Doc.createGiftDoc             | 前置条件 | 礼物列表不为空                                  |
|                               | 后置条件 | 持久化更新涉及的对象的数据                            |



- 需要的服务

| 服务名                                      | 服务                 |
| ---------------------------------------- | ------------------ |
| DocDataService.findSaleRecords           | 返回符合条件的所有单据的持久化对象  |
| DocDataService.findRevenueAndExpenditure | 返回符合条件的所有单据的持久化对象  |
| DocDataService.findRevenueAndExpenditure | 返回符合条件的所有单据的持久化对象的 |



#### 数据层接口规范





##### approvaldata 模块的接口规范

- 提供的服务


| 名称                       | 条目   | 详情                                       |
| ------------------------ | ---- | ---------------------------------------- |
|                          | 语法   | `public ArrayList<HistoryDocPO> getDocumentList()` |
| Approval.getDocuemntList | 前置条件 | 用户已登录                                    |
|                          | 后置条件 | 返回含有所有处于待审批状态的单据列表的持久对象                  |
|                          | 语法   | `public ResultMessage update(HistoryDocPO po)` |
| Approval.update          | 前置条件 | 在数据库中存在相同ID的po                           |
|                          | 后置条件 | 更新一个po                                   |







#####promotiondata 模块的接口规范

- 提供的服务

| 名称                                    | 条目   | 详情                                       |
| ------------------------------------- | ---- | ---------------------------------------- |
|                                       | 语法   | `public ArrayList<PromotionPO> getPromotionList()` |
| PromotionDataService.getPromotionList | 前置条件 | 用户已登录                                    |
|                                       | 后置条件 | 返回含有所有销售策略的持久化对象的列表                      |
|                                       | 语法   | `public ResultMessage insert(PromotionPO po)` |
| PromotionDataService.insert           | 前置条件 | 同样ID的po在数据库中不存在                          |
|                                       | 后置条件 | 在数据库中增加一个po记录                            |
|                                       | 语法   | `public ResultMessage update(PromotionPO po)` |
| PromotionDataService.update           | 前置条件 | 在数据库中存在同样ID的po                           |
|                                       | 后置条件 | 更新一个po                                   |
|                                       | 语法   | `public ResultMessage delete(PromotionPO po)` |
| PromotionDataService.delete           | 前置条件 | 在数据库中存在同样ID的po                           |
|                                       | 后置条件 | 删除一个po                                   |
|                                       | 语法   | `public ArrayList<PromotionPO> getBenefitsPlan(int customerLevel, ArrayList<String> commodityList,double total)` |
| PromotionDataService.getBenefitsPlan  | 前置条件 | 无                                        |
|                                       | 后置条件 | 返回满足条件的销售策略的持久化对象的列表                     |



- 需要的服务



##### docdata 模块的接口规范

- 提供的服务

| 名称                                       | 条目   | 详情                                       |
| ---------------------------------------- | ---- | ---------------------------------------- |
|                                          | 语法   | `public ArrayList<DocPO> findSaleRecords(long startDate, long endDate, String Commodity, String customer, String user, String repository)` |
| docDataService.findSaleRecords           | 前置条件 | 筛选条件合法                                   |
|                                          | 后置条件 | 返回符合筛选条件的销售类单据的持久化对象                     |
|                                          | 语法   | `public ArrayList<DocPO> findDocuments(long startDate, long endDate, DocType type, String customer, String user, String repository)` |
| docDataService.findDocuments             | 前置条件 | 筛选条件合法                                   |
|                                          | 后置条件 | 返回符合筛选条件的所有单据的持久化对象                      |
|                                          | 语法   | `public ArrayList<DocPO> findRevenueAndExpenditure(long startDate, long endDate)` |
| docDataService.findRevenueAndExpenditure | 前置条件 | 起始时间小于截止时间                               |
|                                          | 后置条件 | 返回时间段内的财务类单据的持久化对象                       |



#### 信息视角

##### 数据库表

数据库中包含Promotion表，GiftDoc表，GiftDocItem表